version: v2
# managed:
#   enabled: true
#   override:
#     - file_option: go_package_prefix
#       value: github.com/Arcadian-Sky/musthave-metrics
# inputs:
#   - directory: proto
plugins:
    # Use the latest version of protoc-gen-go
  - remote: buf.build/protocolbuffers/go
    revision: 4
    out: ./gen
    opt: 
     - paths=source_relative
    # Use the latest version of protoc-gen-go-grpc
  - remote: buf.build/grpc/go
    revision: 4
    out: ./gen
    opt:
      - paths=source_relative
      - require_unimplemented_servers=false
  # grpc-ecosystem/gateway version 2.21.0
  # - local: protoc-gen-grpc-gateway
  - remote: buf.build/grpc-ecosystem/gateway:v2.21.0
    out: ./gen
    opt:
      - paths=source_relative
      - allow_repeated_fields_in_body=true
  # Use the latest version of validate-go
  - remote: buf.build/bufbuild/validate-go
    out: ./gen
    opt:
    - paths=source_relative
  # - remote: buf.build/connectrpc/go
  #   out: ./gen
  #   opt: paths=source_relative
  - local: protoc-gen-openapiv2
    out: ./gen
    opt: allow_repeated_fields_in_body=true
# Генерирует один общий файл .swagger.json
  - local: protoc-gen-openapiv2
    out: ./gen
    opt:
    - allow_merge=true